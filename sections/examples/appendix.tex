% !Mode:: "TeX:UTF-8"
% !TEX program  = xelatex
\section*{数据获取函数}\label{A:data}
\SQL{utils.py}{code/hive_mloptimizer/ssb_Q1.1.sql}

(tok_query 
    (tok_from (tok_join 
        (tok_tabref (tok_tabname lineorder)) 
        (tok_tabref (tok_tabname dates)))
    ) 
    (tok_insert 
        (tok_destination (tok_dir tok_tmp_file)) 
        (tok_select (tok_selexpr (tok_function sum 
            (* 
                (tok_table_or_col lo_extendedprice) 
                (tok_table_or_col lo_discount)
            )) revenue)
        ) 
        (tok_where (and (and (and 
                (= 
                    (tok_table_or_col lo_orderdate) 
                    (tok_table_or_col d_datekey)
                ) 
                (= (tok_table_or_col d_year) 1993 )
            ) 
            (tok_function between kw_false 
                (tok_table_or_col lo_discount) 1 3)) 
            (< (tok_table_or_col lo_quantity) 25))
        )
    )
)
